var handler,cartBtnSelector=["[name='checkout']","[href='/checkout']","form[action='/checkout'] input[type='submit']","input[name='checkout']","button[name='checkout']","input[value='Checkout']","input[value='Check out']"].join(", "),uniqueCartArray=[],cartFlagChange=0;$(document).ready(function(){uniqueCartArray=[...cartArray.reduce((t,e)=>(t.has(e.pid)||t.set(e.pid,Object.assign({qty:0},e)),t.get(e.pid).qty=t.get(e.pid).qty+parseInt(e.qty_before),t),new Map).values()],$(cartBtnSelector).click(function(n){n.preventDefault();var a=$(this);"1"==cartFlagChange?swal({title:ak_mm.general_setting.title,text:ak_mm.general_setting.model_changePromptText,icon:"warning",buttons:[ak_mm.general_setting.model_dissmiss_btn,ak_mm.general_setting.model_fix_cart_btn],dangerMode:!0,closeOnClickOutside:!1}).then(t=>{t&&(swal({title:"Success",text:ak_mm.general_setting.model_changePromptText,buttons:!1,icon:"success"}),cartFlagChange="0",$("input[name='update'],button[name='update']").click())}):function(n){$.get("/cart.js",function(a){var r=[];$.each(a.items,function(t,e){var n={},a=e.title;n.p_title=a;var i=e.product_id;n.pid=i;var c=cartArray[i+"_min"];n.minProductMetaQty=c;var m=cartArray[i+"_max"];n.maxProductMetaQty=m;var l="ak_p_maQ_"+i;n.pidMaxConcate=l;var _="ak_p_miQ_"+i;n.pidMinConcate=_;var o=e.quantity;n.qty_before=o,r.push(n)});var i=[...r.reduce((t,e)=>(t.has(e.pid)||t.set(e.pid,Object.assign({qty:0},e)),t.get(e.pid).qty=t.get(e.pid).qty+parseInt(e.qty_before),t),new Map).values()],c=ak_mm.CartTotalAmt/100,m=1;if($.each(i,function(t,e){var n=ak_mm.general_setting.minProQty,a=ak_mm.general_setting.maxProQty,r=(e.pid,e.p_title),i=e.qty,c=e.minProductMetaQty,l=e.maxProductMetaQty;if(n=(n=n.replace("{{quantity}}",c)).replace("{{product_title}}",r),a=(a=a.replace("{{quantity}}",l)).replace("{{product_title}}",r),!wcn(c)||!wcn(l)){var _=function(t,e,n,a,r){if(!wcn(e)&&parseInt(t)<parseInt(e))return swal({title:ak_mm.general_setting.title,text:a,icon:"error",buttons:ak_mm.general_setting.model_ok_btn}),!1;if(!wcn(n)&&parseInt(t)>parseInt(n))return swal({title:ak_mm.general_setting.title,text:r,icon:"error",buttons:ak_mm.general_setting.model_ok_btn}),!1}(i,c,l,n,a);if(!wcn(_))return m=0,!1}}),0==m)return!1;if(!wcn(ak_mm.cartMinAmt)){var l=parseFloat(ak_mm.cartMinAmt),c=parseFloat(ak_mm.CartTotalAmt)/100,_=ak_mm.general_setting.minOrderAmt;_=_.replace("{{amount}}",l);var o=t(c,l,_);if(!wcn(o))return m=0,!1}if(0==m)return!1;if(!wcn(ak_mm.cartMaxAmt)){var s=parseFloat(ak_mm.cartMaxAmt),c=parseFloat(ak_mm.CartTotalAmt)/100,u=ak_mm.general_setting.maxOrderAmt;u=u.replace("{{amount}}",s);var o=e(c,s,u);if(!wcn(o))return m=0,!1}if(0==m)return!1;if(!wcn(ak_mm.cartMinQty)){var g=parseInt(ak_mm.cartMinQty),k=parseInt(ak_mm.cartTotalQty),_=ak_mm.general_setting.minOrderQty;_=_.replace("{{quantity}}",g);var o=t(k,g,_);if(!wcn(o))return m=0,!1}if(0==m)return!1;if(!wcn(ak_mm.cartMaxQty)){var d=parseInt(ak_mm.cartMaxQty),c=parseInt(ak_mm.cartTotalQty),u=ak_mm.general_setting.maxOrderQty;u=u.replace("{{quantity}}",d);var o=e(c,d,u);if(!wcn(o))return m=0,!1}if(0==m)return!1;n.unbind("click"),n.click()},"json")}(a)});$("input[name='add'],button[name='add']").click(function(t){t.preventDefault();var e=ak_mm.general_setting.minProQty,n=ak_mm.general_setting.maxProQty,a=ak_mm.product_min_qty,r=ak_mm.product_max_qty,i=ak_mm.product_title;e=(e=e.replace("{{quantity}}",a)).replace("{{product_title}}",i),n=(n=n.replace("{{quantity}}",r)).replace("{{product_title}}",i);var c,m=$(this).closest("body").find("select[name='quantity'],input[name='quantity']").val(),l=$(this);$.each(uniqueCartArray,function(t,e){e.pid==ak_mm.pid&&(c=e.qty)}),c=wcn(c)?0:c;var _=function(t,e,n,a,r,i,c){if(wcn(e)){if(wcn(n))i.unbind("click"),i.click();else if(parseInt(t)>parseInt(n))return swal({title:ak_mm.general_setting.title,text:r,icon:"warning",buttons:ak_mm.general_setting.model_ok_btn,closeOnClickOutside:!1}).then(t=>{t&&(i.unbind("click"),i.click())}),!1}else{if(parseInt(t)<parseInt(e))return swal({title:ak_mm.general_setting.title,text:a,icon:"warning",buttons:[ak_mm.general_setting.model_dissmiss_btn,ak_mm.general_setting.model_ok_btn],dangerMode:!0,closeOnClickOutside:!1}).then(t=>{t&&(i.unbind("click"),i.click())}),!1;if(parseInt(t)>parseInt(n))return swal({title:ak_mm.general_setting.title,text:r,icon:"warning",buttons:[ak_mm.general_setting.model_dissmiss_btn,ak_mm.general_setting.model_ok_btn],dangerMode:!0,closeOnClickOutside:!1}).then(t=>{t&&(i.unbind("click"),i.click())}),!1;i.unbind("click"),i.click()}}(c+=parseInt(m),a,r,e,n,l);wcn(_)&&(l.unbind("click"),l.click())});function t(t,e,n){if(t<e)return swal({title:ak_mm.general_setting.title,text:n,icon:"error",buttons:ak_mm.general_setting.model_ok_btn}),!1}function e(t,e,n){if(t>e)return swal({title:ak_mm.general_setting.title,text:n,icon:"error",buttons:ak_mm.general_setting.model_ok_btn}),!1}$(document).on("change","input[name='updates[]'],button[name='updates[]']",function(){cartFlagChange=1})});